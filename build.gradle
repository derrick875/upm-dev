//-*-mode: groovy-*-
/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */
plugins {
   id 'java'
   id 'org.springframework.boot' version '2.2.6.RELEASE'
   id 'io.spring.dependency-management' version '1.0.8.RELEASE'
   id 'jacoco'
}

repositories {
    maven {
        url = uri("http://artifacts.nets.com.sg:8071/repository/nets-gradle-proxy")
    }
    maven {
        name = "nets-npx-snapshots"
        url = uri("http://artifacts.nets.com.sg:8071/repository/nets-npx-snapshots/")
        mavenContent {
            snapshotsOnly()
        }
        credentials {
            username = "2HQ3rp0_"
            password = "cP5I7cGXOoIk9HtBTu9aaTT9pyEtFvIXQ0WQkUevAYwq"
        }
        authentication {
            basic(BasicAuthentication)
        }
    }
    maven {
        name = "nets-npx-releases"
        url = uri("http://artifacts.nets.com.sg:8071/repository/nets-npx-releases/")
        mavenContent {
            releasesOnly()
        }
        credentials {
            username = "2HQ3rp0_"
            password = "cP5I7cGXOoIk9HtBTu9aaTT9pyEtFvIXQ0WQkUevAYwq"
        }
        authentication {
            basic(BasicAuthentication)
        }
    }
    mavenLocal()

}


version = '1.0.0-SNAPSHOT'

sourceCompatibility = 1.8
targetCompatibility = 1.8

springBoot {
  buildInfo {
    properties {
      group = 'com.nets.nps'
      artifact = 'npx2-paynow'
      name = 'paynow'
    }
  }
}

dependencies {
  implementation 'org.springframework.boot:spring-boot-dependencies:2.2.6.RELEASE'
  implementation 'org.springframework.boot:spring-boot-starter-web'
  implementation 'org.springframework.boot:spring-boot-starter-webflux'
  implementation 'org.springframework.boot:spring-boot-starter-security'
  implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
  implementation 'org.springframework.boot:spring-boot-starter-actuator'
  implementation 'org.springframework.boot:spring-boot-devtools'
  implementation 'org.springframework.security:spring-security-oauth2-client'
  implementation 'mysql:mysql-connector-java:6.0.5'
  implementation 'org.springframework:spring-jms'
  implementation 'javax.jms:javax.jms-api:2.0.1'
  implementation 'com.solacesystems:sol-jms:10.0.0'
  implementation 'com.nets.upos:core:0.0.3-SNAPSHOT'
  implementation 'com.nets.upos:commons:0.0.3-SNAPSHOT'
  implementation 'com.google.guava:guava:28.2-jre'
  implementation 'org.apache.commons:commons-lang3:3.9'
  implementation 'org.apache.httpcomponents:httpclient:4.5.3'
  implementation 'org.modelmapper:modelmapper:2.3.0'
  implementation 'com.nets.upos:hsmproxy:1.0.0-SNAPSHOT'
  //implementation 'com.nets.upos:hsmproxy:0.0.2-SNAPSHOT'

  implementation 'log4j:log4j:1.2.7'

  testImplementation 'org.junit.jupiter:junit-jupiter-api'
  testImplementation 'org.junit.jupiter:junit-jupiter-params'
  testImplementation 'org.mockito:mockito-junit-jupiter:2.17.0'
  testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine'
  testImplementation('org.springframework.boot:spring-boot-starter-test') {
    exclude group: 'junit', module: 'junit'
  }
  testRuntimeOnly 'com.h2database:h2'

  components {
        withModule('org.springframework:spring-beans') {
            allVariants {
                withDependencyConstraints {
                    // Need to patch constraints because snakeyaml is an optional dependency
                    it.findAll { it.name == 'snakeyaml' }.each { it.version { strictly '1.19' } }
                }
            }
        }
    }
}

test {
  useJUnitPlatform {
    excludeTags 'integration'
  }
}

task integrationTest(type: Test) {
  // TODO get active profiles from command line
  // systemProperty 'spring.profiles.active', 'local'
  useJUnitPlatform {
    includeTags 'integration'
  }
}

task copyArtifacts(type: Copy) {
    from ('.') {
    include 'AppConfigs/**'
    include 'DBScripts/**'
    }

    from('build/libs/') {
    }

  into 'target'
}

